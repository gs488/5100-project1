<!DOCTYPE html>
<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <title>Project 1</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <h3 class="pageTitle">
        INFO 3300 Project 1 <br />
        Grace Song gs488, Zhongkai Liu zl777, Jerry Xu lx46
    </h3>

    <div class="section enrollmentSection">
        <h3 class="chartTitle">Enrollments</h3>
        <div class="chartDiv enrollmentChart" id="chartDiv6"></div>
        <div class="chartDiv enrollmentChart" id="chartDiv7"></div>
    </div>

    <div class="section locationSection">
        <h3 class="chartTitle">Location Distribution</h3>
        <div class="chartDiv locationChart" id="chartDiv8"></div>
        <div class="chartDiv locationChart" id="chartDiv9"></div>
        <div class="chartDiv locationChart" id="chartDiv10"></div>
        <div class="chartDiv locationChart" id="chartDiv11"></div>
    </div>

    <div class="section salarySection">
        <h3 class="chartTitle">Average Salaries</h3>
        <div class="chartDiv salaryChart" id="chartDiv5"></div>
        <div class="chartDiv salaryChart" id="chartDiv1"></div>
        <div class="chartDiv salaryChart" id="chartDiv2"></div>
        <div class="chartDiv salaryChart" id="chartDiv3"></div>
        <div class="chartDiv salaryChart" id="chartDiv4"></div>
    </div>

    <script>
        // svg setup
        const width = window.innerWidth * 0.49;
        const height = window.innerHeight * 0.6;
        const margins = { top: 20, right: 50, bottom: 30, left: 50 };
        const chartWidth = width - margins.right - margins.left;
        const chartHeight = height - margins.top - margins.bottom;
        const barWidth = width * 0.03;
        const barPadding = barWidth / 4;

        const widthLarge = window.innerWidth * 0.9;
        const heightLarge = window.innerHeight * 0.7;
        const chartWidthLarge = widthLarge - margins.right - margins.left;
        const chartHeightLarge = heightLarge - margins.top - margins.bottom;
        const skinnyBarWidth = widthLarge * 0.02;

        // legend position
        const legendPadding = 100;
        const legendX = (width - legendPadding * 1.5) / 2;
        const legendY = 0;
        const legendXLarge = (widthLarge - legendPadding * 3.5) / 2;
        const legendYLarge = 0;

        // colors for four groups
        const colorISBachelors = "steelblue";
        const colorISMasters = "orange";
        const colorCSBachelors = "green";
        const colorCSMasters = "purple";

        // create svgs and charts
        const chartDiv1 = d3.select("#chartDiv1");
        const chartDiv2 = d3.select("#chartDiv2");
        const chartDiv3 = d3.select("#chartDiv3");
        const chartDiv4 = d3.select("#chartDiv4");
        const chartDiv5 = d3.select("#chartDiv5");
        const chartDiv6 = d3.select("#chartDiv6");
        const chartDiv7 = d3.select("#chartDiv7");
        const chartDiv8 = d3.select("#chartDiv8");
        const chartDiv9 = d3.select("#chartDiv9");
        const chartDiv10 = d3.select("#chartDiv10");
        const chartDiv11 = d3.select("#chartDiv11");

        // chart 1
        chartDiv1
            .append("h4")
            .attr("class", "chartTitle")
            .text(" IS Bachelors vs. IS Masters");

        const svg1 = chartDiv1
            .append("svg")
            .attr("id", "svg1")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 2
        chartDiv2
            .append("h4")
            .attr("class", "chartTitle")
            .text(" CS Bachelors vs. CS Masters");

        const svg2 = chartDiv2
            .append("svg")
            .attr("id", "svg2")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 3
        chartDiv3
            .append("h4")
            .attr("class", "chartTitle")
            .text(" IS Bachelors vs. CS Bachelors");

        const svg3 = chartDiv3
            .append("svg")
            .attr("id", "svg3")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 4
        chartDiv4
            .append("h4")
            .attr("class", "chartTitle")
            .text(" IS Masters vs. CS Masters");

        const svg4 = chartDiv4
            .append("svg")
            .attr("id", "svg4")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 5
        chartDiv5
            .append("h4")
            .attr("class", "chartTitle")
            .text("IS Bachelors & IS Masters & CS Bachelors & CS Masters");

        const svg5 = chartDiv5
            .append("svg")
            .attr("id", "svg5")
            .attr("width", String(widthLarge))
            .attr("height", String(heightLarge));

        // chart 6
        chartDiv6
            .append("h4")
            .attr("class", "chartTitle")
            .text("IS vs CS Bachelors");

        const svg6 = chartDiv6
            .append("svg")
            .attr("id", "svg6")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 7
        chartDiv7
            .append("h4")
            .attr("class", "chartTitle")
            .text("IS vs CS Masters");

        const svg7 = chartDiv7
            .append("svg")
            .attr("id", "svg7")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 8
        chartDiv8
            .append("h4")
            .text("IS Bachelors")
            .attr("class", "chartTitle");

        const svg8 = chartDiv8
            .append("svg")
            .attr("id", "svg8")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 9
        chartDiv9
            .append("h4")
            .text("CS Bachelors")
            .attr("class", "chartTitle");

        const svg9 = chartDiv9
            .append("svg")
            .attr("id", "svg9")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 10
        chartDiv10
            .append("h4")
            .text("IS Masters")
            .attr("class", "chartTitle");

        const svg10 = chartDiv10
            .append("svg")
            .attr("id", "svg10")
            .attr("width", String(width))
            .attr("height", String(height));

        // chart 11
        chartDiv11
            .append("h4")
            .text("CS Masters")
            .attr("class", "chartTitle");

        const svg11 = chartDiv11
            .append("svg")
            .attr("id", "svg11")
            .attr("width", String(width))
            .attr("height", String(height));

        // retrieve JSON file
        d3.json("./salaries.json").then(data => {
            // filter data into different groups
            const dataIS = data.filter(d => {
                return d["major"] === "IS";
            });

            const dataCS = data.filter(d => {
                return d["major"] === "CS";
            });

            const dataBachelors = data.filter(d => {
                return d["degree"] === "Bachelors";
            });

            const dataMasters = data.filter(d => {
                return d["degree"] === "Masters";
            });

            const dataISBachelors = data.filter(d => {
                return d["major"] === "IS" && d["degree"] === "Bachelors";
            });

            const dataISMasters = data.filter(d => {
                return d["major"] === "IS" && d["degree"] === "Masters";
            });

            const dataCSBachelors = data.filter(d => {
                return d["major"] === "CS" && d["degree"] === "Bachelors";
            });

            const dataCSMasters = data.filter(d => {
                return d["major"] === "CS" && d["degree"] === "Masters";
            });

            // function to calculate number of student in a certain location of a certain group
            let numberOfLocation = (dataGroup, location) => {
                let num = 0;
                dataGroup.forEach((d, i) => {
                    num += Number(d[location]);
                });
                return num;
            };

            // number of different locations of four groups
            const numISBachelorsNYC = numberOfLocation(dataISBachelors, "nyc");
            const numISBachelorsSF = numberOfLocation(dataISBachelors, "sf");
            const numISBachelorsTotal = numberOfLocation(
                dataISBachelors,
                "total"
            );

            const numCSBachelorsNYC = numberOfLocation(dataCSBachelors, "nyc");
            const numCSBachelorsSF = numberOfLocation(dataCSBachelors, "sf");
            const numCSBachelorsTotal = numberOfLocation(
                dataCSBachelors,
                "total"
            );

            const numISMastersNYC = numberOfLocation(dataISMasters, "nyc");
            const numISMastersSF = numberOfLocation(dataISMasters, "sf");
            const numISMastersTotal = numberOfLocation(dataISMasters, "total");
            const numCSMastersNYC = numberOfLocation(dataCSMasters, "nyc");
            const numCSMastersSF = numberOfLocation(dataCSMasters, "sf");
            const numCSMastersTotal = numberOfLocation(dataCSMasters, "total");

            // data for the donut chart
            const percentISBachelorsNYC =
                numISBachelorsNYC / numISBachelorsTotal;
            const percentISBachelorsSF = numISBachelorsSF / numISBachelorsTotal;
            const percentISBachelorsOther =
                1 - percentISBachelorsNYC - percentISBachelorsSF;

            const percentCSBachelorsNYC =
                numCSBachelorsNYC / numCSBachelorsTotal;
            const percentCSBachelorsSF = numCSBachelorsSF / numCSBachelorsTotal;
            const percentCSBachelorsOther =
                1 - percentCSBachelorsNYC - percentCSBachelorsSF;

            const percentISMastersNYC = numISMastersNYC / numISMastersTotal;
            const percentISMastersSF = numISMastersSF / numISMastersTotal;
            const percentISMastersOther =
                1 - percentISMastersNYC - percentISMastersSF;

            const percentCSMastersNYC = numCSMastersNYC / numCSMastersTotal;
            const percentCSMastersSF = numCSMastersSF / numCSMastersTotal;
            const percentCSMastersOther =
                1 - percentCSMastersNYC - percentCSMastersSF;

            const arrayISBachelors = [
                { location: "New York", percent: percentISBachelorsNYC },
                { location: "San Francisco", percent: percentISBachelorsSF },
                { location: "Other", percent: percentISBachelorsOther }
            ];

            const arrayCSBachelors = [
                { location: "New York", percent: percentCSBachelorsNYC },
                { location: "San Francisco", percent: percentCSBachelorsSF },
                { location: "Other", percent: percentCSBachelorsOther }
            ];

            const arrayISMasters = [
                { location: "New York", percent: percentISMastersNYC },
                { location: "San Francisco", percent: percentISMastersSF },
                { location: "Other", percent: percentISMastersOther }
            ];

            const arrayCSMasters = [
                { location: "New York", percent: percentCSMastersNYC },
                { location: "San Francisco", percent: percentCSMastersSF },
                { location: "Other", percent: percentCSMastersOther }
            ];

            // console.log(arrayISBachelors);
            // console.log(arrayCSMasters);
            // console.log(arrayISBachelors);
            // console.log(arrayCSMasters);

            // just console.log() to see the percentages
            // console.log(percentISBachelorsNYC);
            // console.log(percentISBachelorsSF);
            // console.log(percentISBachelorsOther);

            // console.log(percentCSBachelorsNYC);
            // console.log(percentCSBachelorsSF);
            // console.log(percentCSBachelorsOther);

            // console.log(percentISMastersNYC);
            // console.log(percentISMastersSF);
            // console.log(percentISMastersOther);

            // console.log(percentCSMastersNYC);
            // console.log(percentCSMastersSF);
            // console.log(percentCSMastersOther);

            // max of salary of different groups
            const salaryMax = d3.max(data, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxIS = d3.max(dataIS, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxCS = d3.max(dataCS, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxBachelors = d3.max(dataBachelors, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxMasters = d3.max(dataMasters, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxISBachelors = d3.max(dataISBachelors, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxISMasters = d3.max(dataISMasters, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxCSBachelors = d3.max(dataCSBachelors, d => {
                return Math.max(d["salary"]);
            });

            const salaryMaxCSMasters = d3.max(dataCSMasters, d => {
                return Math.max(d["salary"]);
            });

            // const dateExtent = d3.extent(data, d => d["classyear"]);

            // scales
            const dateScale = d3
                .scaleTime()
                .domain([new Date(2012, 0, 1), new Date(2018, 0, 1)])
                .range([0, chartWidth]);

            const yearScale = d3
                .scaleTime()
                .domain([new Date(2011, 6, 1), new Date(2018, 6, 1)])
                .range([0, chartWidth]);

            const yearScaleLarge = d3
                .scaleTime()
                .domain([new Date(2011, 6, 1), new Date(2018, 6, 1)])
                .range([0, chartWidthLarge]);

            const salaryScale = d3
                .scaleLinear()
                .domain([50000, 120000])
                .range([chartHeight, 0]);

            const salaryScaleAllData = d3
                .scaleLinear()
                .domain([50000, 120000])
                .range([chartHeightLarge, 0]);

            const salaryScaleIS = salaryScale;

            const salaryScaleCS = salaryScale;

            const salaryScaleBachelors = salaryScale;

            const salaryScaleMasters = salaryScale;

            const enrollmentScale = d3
                .scaleLinear()
                .domain([0, 250])
                .range([chartHeight, 0]);

            const bachelorsEnrollmentScale = enrollmentScale;

            const mastersEnrollmentScale = enrollmentScale;

            // Gridlines
            let salaryGridlines = d3
                .axisLeft(salaryScale)
                .tickSize(-chartWidth)
                .tickFormat("");

            let salaryGridlinesLarge = d3
                .axisLeft(salaryScaleAllData)
                .tickSize(-chartWidthLarge)
                .tickFormat("");

            let enrollmentGridlines = d3
                .axisLeft(enrollmentScale)
                .tickSize(-chartWidth)
                .ticks(5)
                .tickFormat("");

            svg1.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(salaryGridlines);

            svg2.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(salaryGridlines);

            svg3.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(salaryGridlines);

            svg4.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(salaryGridlines);

            svg5.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(salaryGridlinesLarge);

            svg6.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(enrollmentGridlines);

            svg7.append("g")
                .attr("class", "y gridlines")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                )
                .call(enrollmentGridlines);

            // Axises
            const dateAxis = d3
                .axisBottom(dateScale)
                .tickFormat(d3.timeFormat("%Y"))
                .tickSize(5)
                .tickPadding(10);

            const yearAxis = d3
                .axisBottom(yearScale)
                .tickFormat(d3.timeFormat("%Y"))
                .tickSize(0)
                .tickPadding(10);

            const yearAxisLarge = d3
                .axisBottom(yearScaleLarge)
                .tickFormat(d3.timeFormat("%Y"))
                .tickSize(0)
                .tickPadding(10);

            const salaryAxisIS = d3.axisLeft(salaryScaleIS).ticks(6);

            const salaryAxisCS = d3.axisLeft(salaryScaleCS).ticks(6);

            const salaryAxisBachelors = d3
                .axisLeft(salaryScaleBachelors)
                .ticks(6);

            const salaryAxisMasters = d3.axisLeft(salaryScaleMasters).ticks(6);

            const salaryAxisAllData = d3.axisLeft(salaryScaleAllData).ticks(6);

            const enrollmentAxis = d3.axisLeft(enrollmentScale).ticks(5);

            const bachelorsEnrollmentAxis = enrollmentAxis;

            const mastersEnrollmentAxis = enrollmentAxis;

            // salary text on bar
            let salaryText = svg1
                .append("text")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .attr("id", "salary_text")
                .attr("text-anchor", "middle")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0);

            // append chart groups for svg
            const chart1 = svg1
                .append("g")
                .attr("id", "chart1")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );
            const chart2 = svg2
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );
            const chart3 = svg3
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );

            const chart4 = svg4
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );

            const chart5 = svg5
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );

            const chart6 = svg6
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );

            const chart7 = svg7
                .append("g")
                .attr("class", "chart")
                .attr(
                    "transform",
                    "translate(" + margins.left + "," + margins.top + ")"
                );

            // ------ Chart 1, IS Bachelors vs. IS Masters ----
            // append axises
            svg1.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(yearAxis);

            svg1.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(salaryAxisIS);

            // draw Chart 1
            dataIS.forEach((d, i) => {
                let x = yearScale(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["degree"] === "Bachelors") {
                    x -= barWidth + barPadding / 2;
                    fill = colorISBachelors;
                } else {
                    x += barPadding / 2;
                    fill = colorISMasters;
                }
                let y = salaryScaleIS(d["salary"]);

                let bar = chart1
                    .append("rect")
                    .attr("width", barWidth)
                    .attr("height", chartHeight - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });

            // add legend for char 1
            let legend1 = svg1
                .append("g")
                .attr("id", "legend1")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend1
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISBachelors)
                .text("IS Bachelors");

            legend1
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorISMasters)
                .text("IS Masters");

            // ------ Chart 2, CS Bachelors vs. CS Masters ----
            // create axises
            svg2.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(yearAxis);

            svg2.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(salaryAxisCS);

            //create bars
            dataCS.forEach((d, i) => {
                let x = yearScale(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["degree"] === "Bachelors") {
                    x -= barWidth + barPadding / 2;
                    fill = colorCSBachelors;
                } else {
                    x += barPadding / 2;
                    fill = colorCSMasters;
                }
                let y = salaryScaleCS(d["salary"]);

                let bar = chart2
                    .append("rect")
                    .attr("width", barWidth)
                    .attr("height", chartHeight - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });

            // add legend for char 2
            let legend2 = svg2
                .append("g")
                .attr("id", "legend2")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend2
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorCSBachelors)
                .text("CS Bachelors");

            legend2
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorCSMasters)
                .text("CS Masters");

            // ------ Chart 3: IS Bachelors vs. CS Bachelors
            svg3.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(yearAxis);

            svg3.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(salaryAxisBachelors);

            //create bars
            dataBachelors.forEach((d, i) => {
                let x = yearScale(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["major"] === "CS") {
                    x += barPadding / 2;
                    fill = colorCSBachelors;
                } else {
                    x -= barWidth + barPadding / 2;
                    fill = colorISBachelors;
                }
                let y = salaryScaleBachelors(d["salary"]);

                let bar = chart3
                    .append("rect")
                    .attr("width", barWidth)
                    .attr("height", chartHeight - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });

            // add legend for char 3
            let legend3 = svg3
                .append("g")
                .attr("id", "legend3")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend3
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISBachelors)
                .text("IS Bachelors");

            legend3
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorCSBachelors)
                .text("CS Bachelors");

            // ------ Chart 4, IS Masters vs. CS Masters ----

            svg4.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(yearAxis);

            svg4.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(salaryAxisMasters);

            //create bars
            dataMasters.forEach((d, i) => {
                let x = yearScale(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["major"] === "CS") {
                    x += barPadding / 2;
                    fill = colorCSMasters;
                } else {
                    x -= barWidth + barPadding / 2;
                    fill = colorISMasters;
                }
                let y = salaryScaleMasters(d["salary"]);

                let bar = chart4
                    .append("rect")
                    .attr("width", barWidth)
                    .attr("height", chartHeight - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });

            // add legend for char 4
            let legend4 = svg4
                .append("g")
                .attr("id", "legend4")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend4
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISMasters)
                .text("IS Masters");

            legend4
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorCSMasters)
                .text("CS Masters");

            // ------ Chart 5, IS Bachelors, IS Masters, CS Bachelors, and CS Masters ----

            svg5.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeightLarge) +
                        ")"
                )
                .call(yearAxisLarge);

            svg5.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(salaryAxisAllData);

            //create bars for IS
            dataIS.forEach((d, i) => {
                let x = yearScaleLarge(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["degree"] === "Bachelors") {
                    x -= skinnyBarWidth * 2 + barPadding * 1.5;
                    fill = colorISBachelors;
                } else {
                    x -= skinnyBarWidth + barPadding * 0.5;
                    fill = colorISMasters;
                }
                let y = salaryScaleAllData(d["salary"]);

                let bar = chart5
                    .append("rect")
                    .attr("width", skinnyBarWidth)
                    .attr("height", chartHeightLarge - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });
            //create bars for CS
            dataCS.forEach((d, i) => {
                let x = yearScaleLarge(new Date(d["classyear"], 0, 1));
                let fill = "";
                if (d["degree"] === "Bachelors") {
                    x += barPadding * 0.5;
                    fill = colorCSBachelors;
                } else {
                    x += skinnyBarWidth + barPadding * 1.5;
                    fill = colorCSMasters;
                }
                let y = salaryScaleAllData(d["salary"]);

                let bar = chart5
                    .append("rect")
                    .attr("width", skinnyBarWidth)
                    .attr("height", chartHeightLarge - y)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("year", d["classyear"])
                    .attr("major", d["major"])
                    .attr("degree", d["degree"])
                    .style("fill", fill)
                    .style("stroke", "none");
            });

            // add legend for chart 5
            let legend5 = svg5
                .append("g")
                .attr("id", "legend5")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendXLarge + "," + legendYLarge + ")"
                );

            legend5
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISBachelors)
                .text("IS Bachelors");

            legend5
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorISMasters)
                .text("IS Masters");

            legend5
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding * 2)
                .attr("y", 0)
                .style("fill", colorCSBachelors)
                .text("CS Bachelors");

            legend5
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding * 3)
                .attr("y", 0)
                .style("fill", colorCSMasters)
                .text("CS Masters");

            // ------ Chart 6, IS vs CS bachelors enrollment line graph ----

            svg6.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(dateAxis);

            svg6.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(bachelorsEnrollmentAxis);

            let lineGen = d3
                .line()
                .x(d => dateScale(new Date(d["classyear"], 0, 1)))
                .y(d => bachelorsEnrollmentScale(d["total"]))
                .curve(d3.curveMonotoneX);

            chart6
                .append("path")
                .datum(dataISBachelors)
                .attr("class", "line")
                .attr("fill", "none")
                .attr("stroke", colorISBachelors)
                .attr("stroke-width", 3)
                .attr("d", lineGen);

            dataISBachelors.forEach((d, i) => {
                let circle = chart6
                    .append("circle")
                    .attr("r", 3)
                    .attr("fill", colorISBachelors)
                    .attr("cx", dateScale(new Date(d["classyear"], 0, 1)))
                    .attr("cy", bachelorsEnrollmentScale(d["total"]));
            });

            chart6
                .append("path")
                .datum(dataCSBachelors)
                .attr("class", "line")
                .attr("fill", "none")
                .attr("stroke", colorCSBachelors)
                .attr("stroke-width", 3)
                .attr("d", lineGen);

            dataCSBachelors.forEach((d, i) => {
                let circle = chart6
                    .append("circle")
                    .attr("r", 3)
                    .attr("fill", colorCSBachelors)
                    .attr("cx", dateScale(new Date(d["classyear"], 0, 1)))
                    .attr("cy", bachelorsEnrollmentScale(d["total"]));
            });

            // add legend for chart 6
            let legend6 = svg6
                .append("g")
                .attr("id", "legend3")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend6
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISBachelors)
                .text("IS Bachelors");

            legend6
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorCSBachelors)
                .text("CS Bachelors");

            // ------ Chart 7, IS vs CS masters enrollment line graph ----

            svg7.append("g")
                .attr("class", "x axis")
                .attr(
                    "transform",
                    "translate(" +
                        margins.left +
                        ", " +
                        (margins.top + chartHeight) +
                        ")"
                )
                .call(dateAxis);

            svg7.append("g")
                .attr("class", "y axis")
                .attr(
                    "transform",
                    "translate(" + margins.left + ", " + margins.top + ")"
                )
                .call(mastersEnrollmentAxis);

            lineGen = d3
                .line()
                .x(d => dateScale(new Date(d["classyear"], 0, 1)))
                .y(d => mastersEnrollmentScale(d["total"]))
                .curve(d3.curveMonotoneX);

            chart7
                .append("path")
                .datum(dataISMasters)
                .attr("class", "line")
                .attr("fill", "none")
                .attr("stroke", colorISMasters)
                .attr("stroke-width", 3)
                .attr("d", lineGen);

            dataISMasters.forEach((d, i) => {
                let circle = chart7
                    .append("circle")
                    .attr("r", 3)
                    .attr("fill", colorISMasters)
                    .attr("cx", dateScale(new Date(d["classyear"], 0, 1)))
                    .attr("cy", mastersEnrollmentScale(d["total"]));
            });

            chart7
                .append("path")
                .datum(dataCSMasters)
                .attr("class", "line")
                .attr("fill", "none")
                .attr("stroke", colorCSMasters)
                .attr("stroke-width", 3)
                .attr("d", lineGen);

            dataCSMasters.forEach((d, i) => {
                let circle = chart7
                    .append("circle")
                    .attr("r", 3)
                    .attr("fill", colorCSMasters)
                    .attr("cx", dateScale(new Date(d["classyear"], 0, 1)))
                    .attr("cy", mastersEnrollmentScale(d["total"]));
            });

            // add legend for chart 7
            let legend7 = svg7
                .append("g")
                .attr("id", "legend4")
                .attr("class", "legend")
                .attr(
                    "transform",
                    "translate(" + legendX + "," + legendY + ")"
                );

            legend7
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", 0)
                .attr("y", 0)
                .style("fill", colorISMasters)
                .text("IS Masters");

            legend7
                .append("text")
                .attr("text-anchor", "start")
                .attr("alignment-baseline", "hanging")
                .attr("font-size", "12px")
                .attr("x", legendPadding)
                .attr("y", 0)
                .style("fill", colorCSMasters)
                .text("CS Masters");

            // ------ Chart 8, Location Donut Chart IS Bachelors ----
            let outerR = height * 0.45;
            let innerR = outerR * 0.4;

            let donut1 = svg8
                .append("g")
                .attr(
                    "transform",
                    "translate(" + width / 2 + ", " + height / 2 + ")"
                );

            let color = d3.scaleOrdinal(["#ffe75e", "#1fab89", "#eee"]);

            let pie1 = d3.pie().value(function(d) {
                return d.percent;
            });

            let arc1 = d3
                .arc()
                .innerRadius(innerR)
                .outerRadius(outerR);

            let arcs1 = donut1
                .selectAll("arc")
                .data(pie1(arrayISBachelors))
                .enter()
                .append("g")
                .attr("class", "arc");

            arcs1
                .append("path")
                .attr("fill", function(d, i) {
                    return color(i);
                })
                .attr("d", arc1);

            arcs1
                .append("text")
                .text(d => `${d.data.location}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => `translate(${arc1.centroid(d)})`);

            arcs1
                .append("text")
                .text(d => `${d.data.percent.toLocaleString()}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => {
                    console.log(arc1.centroid(d));
                    let x = arc1.centroid(d)[0];
                    let y = arc1.centroid(d)[1] + 20;
                    return "translate(" + x + ", " + y + ")";
                });

            // ------ Chart 9, Location Donut Chart CS Bachelors ----
            let donut2 = svg9
                .append("g")
                .attr(
                    "transform",
                    "translate(" + width / 2 + ", " + height / 2 + ")"
                );

            let pie2 = d3.pie().value(function(d) {
                return d.percent;
            });

            let arc2 = d3
                .arc()
                .innerRadius(innerR)
                .outerRadius(outerR);

            let arcs2 = donut2
                .selectAll("arc")
                .data(pie2(arrayCSBachelors))
                .enter()
                .append("g")
                .attr("class", "arc");

            arcs2
                .append("path")
                .attr("fill", function(d, i) {
                    return color(i);
                })
                .attr("d", arc2);

            arcs2
                .append("text")
                .text(d => `${d.data.location}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => `translate(${arc2.centroid(d)})`);

            arcs2
                .append("text")
                .text(d => `${d.data.percent.toLocaleString()}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => {
                    console.log(arc2.centroid(d));
                    let x = arc2.centroid(d)[0];
                    let y = arc2.centroid(d)[1] + 20;
                    return "translate(" + x + ", " + y + ")";
                });

            // ------ Chart 10, Location Donut Chart IS Masters ----
            let donut3 = svg10
                .append("g")
                .attr(
                    "transform",
                    "translate(" + width / 2 + ", " + height / 2 + ")"
                );

            let pie3 = d3.pie().value(function(d) {
                return d.percent;
            });

            let arc3 = d3
                .arc()
                .innerRadius(innerR)
                .outerRadius(outerR);

            let arcs3 = donut3
                .selectAll("arc")
                .data(pie3(arrayISMasters))
                .enter()
                .append("g")
                .attr("class", "arc");

            arcs3
                .append("path")
                .attr("fill", function(d, i) {
                    return color(i);
                })
                .attr("d", arc3);

            arcs3
                .append("text")
                .text(d => `${d.data.location}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => `translate(${arc3.centroid(d)})`);

            arcs3
                .append("text")
                .text(d => `${d.data.percent.toLocaleString()}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => {
                    console.log(arc3.centroid(d));
                    let x = arc3.centroid(d)[0];
                    let y = arc3.centroid(d)[1] + 20;
                    return "translate(" + x + ", " + y + ")";
                });

            // ------ Chart 11, Location Donut Chart CS Masters ----
            let donut4 = svg11
                .append("g")
                .attr(
                    "transform",
                    "translate(" + width / 2 + ", " + height / 2 + ")"
                );

            let pie4 = d3.pie().value(function(d) {
                return d.percent;
            });

            let arc4 = d3
                .arc()
                .innerRadius(innerR)
                .outerRadius(outerR);

            let arcs4 = donut4
                .selectAll("arc")
                .data(pie4(arrayCSMasters))
                .enter()
                .append("g")
                .attr("class", "arc");

            arcs4
                .append("path")
                .attr("fill", function(d, i) {
                    return color(i);
                })
                .attr("d", arc4);

            arcs4
                .append("text")
                .text(d => `${d.data.location}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => `translate(${arc4.centroid(d)})`);

            arcs4
                .append("text")
                .text(d => `${d.data.percent.toLocaleString()}`)
                .style("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", d => {
                    console.log(arc4.centroid(d));
                    let x = arc4.centroid(d)[0];
                    let y = arc4.centroid(d)[1] + 20;
                    return "translate(" + x + ", " + y + ")";
                });
        });
    </script>
</body>
